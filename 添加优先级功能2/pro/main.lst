C51 COMPILER V9.02   MAIN                                                                  03/07/2016 13:56:02 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\main.obj
COMPILER INVOKED BY: D:\msprograms\keil4\C51\BIN\C51.EXE ..\main\main.c OPTIMIZE(2,SPEED) BROWSE INCDIR(../head) DEBUG O
                    -BJECTEXTEND PRINT(.\main.lst) OBJECT(.\main.obj)

line level    source

   1          #include <stc15f2k60s2.h>
   2          #include "uart.h"
   3          #include "common.h"
   4          #include "nt_led.h"
   5          #include "vector.h"
   6          #include "eeprom.h"
   7          #include "core.h"
   8          
   9          unsigned long xdata timer_dis = 0;
  10          
  11          void task1(void)
  12          {
  13   1              while(1)
  14   1              {
  15   2      //              delay_ms(80);
  16   2      //              
  17   2      //              uart_send_byte('A');
  18   2                      
  19   2              }       
  20   1      }
  21          
  22          void task0(void)
  23          {
  24   1              while(1)
  25   1              {
  26   2      //              delay_ms(125);
  27   2      //              
  28   2      //              uart_send_byte('C');
  29   2              }
  30   1      }
  31          
  32          void task3(void)
  33          {
  34   1              static xdata unsigned char reve_buf_len = 0;    //初始化串口接收到的数据串长度为0
  35   1      
  36   1              while(1)
  37   1              {
  38   2                      while(1)
  39   2                      {       
  40   3                              reve_buff[reve_buf_len] = uart_reve_byte();     //接收到一个字符并存取到接收缓冲区里面
  41   3                              if(reve_buff[reve_buf_len] == 0)
  42   3                              {
  43   4                                      task_delay(2);
  44   4                              }
  45   3                              else
  46   3                                      break;
  47   3                      }
  48   2      
  49   2                      if(reve_buf_len >= 253)
  50   2                      {
  51   3                              printf("Too much words\r\n");
  52   3                              printf("Please double click the 'SPACE' key to end input\r\n"); 
  53   3                      }       
  54   2                      else
C51 COMPILER V9.02   MAIN                                                                  03/07/2016 13:56:02 PAGE 2   

  55   2                      {
  56   3                              if(reve_buff[reve_buf_len-1] == ' ' && reve_buff[reve_buf_len] == ' ')
  57   3                              {
  58   4                                      uart_send_str("\r\nDo commond\r\n");
  59   4                                      reve_buf_len = 0;
  60   4                              }
  61   3                              else
  62   3                                      uart_send_byte(reve_buff[reve_buf_len]);                //将刚刚接收到的一个字节并且发送给串口软件显示
  63   3      
  64   3                              reve_buf_len ++;
  65   3                      }
  66   2              }       
  67   1      }
  68          
  69          void task2(void)
  70          {
  71   1              xdata unsigned char i = 1;
  72   1      
  73   1              while(1)
  74   1              {
  75   2                      P0 = ~P0;
  76   2                      OS_delay(2000);         
  77   2              }
  78   1      }
  79          
  80          void main(void)
  81          {
  82   1              uart_bartvar(24, 115200);
  83   1      //      timer0_init(1000);
  84   1              timer1_init(10000);
  85   1              EA = 0;
  86   1              ENLED = 0;
  87   1              P2 = 0x06;
  88   1              
  89   1              OS_init();
  90   1      
  91   1              task_create(3, (unsigned int)(&task0), 0);      
  92   1              task_create(2, (unsigned int)(&task1), 0);      
  93   1              task_create(1, (unsigned int)(&task2), 0);
  94   1              task_create(0, (unsigned int)(&task3), 0);      
  95   1      
  96   1              OS_start();
  97   1              
  98   1              while(1);
  99   1      }
 100          
 101          void uart() interrupt 4
 102          {
 103   1              
 104   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    312    ----
   CONSTANT SIZE    =     83    ----
   XDATA SIZE       =      5       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
